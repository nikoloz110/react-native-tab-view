{"version":3,"sources":["TabBarIndicator.tsx"],"names":["Easing","EasingNode","OldEasing","multiply","Extrapolate","Animated","interpolate","interpolateNode","TabBarIndicator","React","Component","navigationState","layout","width","getTabWidth","props","isIndicatorShown","routes","every","_","i","timing","opacity","duration","toValue","easing","in","linear","start","Value","position","inputRange","map","outputRange","reduce","acc","translateX","extrapolate","CLAMP","I18nManager","isRTL","componentDidMount","fadeInIndicator","componentDidUpdate","render","style","backgroundStyle","length","getTranslateX","indicatorWidth","getWidth","styles","indicatorBackground","indicator","transform","left","index","StyleSheet","create","backgroundColor","bottom","right","height"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { StyleSheet, I18nManager, StyleProp, ViewStyle } from 'react-native';\nimport Animated, {\n  Easing as OldEasing,\n  // @ts-ignore\n  EasingNode,\n  // eslint-disable-next-line import/no-unresolved\n} from 'react-native-reanimated';\n\nimport memoize from './memoize';\nimport { Route, SceneRendererProps, NavigationState } from './types';\n\nconst Easing = EasingNode || OldEasing;\n\nexport type GetTabWidth = (index: number) => number;\n\nexport type Props<T extends Route> = SceneRendererProps & {\n  navigationState: NavigationState<T>;\n  width: string | number;\n  style?: StyleProp<ViewStyle>;\n  getTabWidth: GetTabWidth;\n  backgroundStyle?: any;\n};\n\nconst { multiply, Extrapolate } = Animated;\n\n// @ts-ignore\nconst interpolate = Animated.interpolateNode || Animated.interpolate;\n\nexport default class TabBarIndicator<T extends Route> extends React.Component<\n  Props<T>\n> {\n  componentDidMount() {\n    this.fadeInIndicator();\n  }\n\n  componentDidUpdate() {\n    this.fadeInIndicator();\n  }\n\n  private fadeInIndicator = () => {\n    const { navigationState, layout, width, getTabWidth } = this.props;\n\n    if (\n      !this.isIndicatorShown &&\n      width === 'auto' &&\n      layout.width &&\n      // We should fade-in the indicator when we have widths for all the tab items\n      navigationState.routes.every((_, i) => getTabWidth(i))\n    ) {\n      this.isIndicatorShown = true;\n\n      Animated.timing(this.opacity, {\n        duration: 150,\n        toValue: 1,\n        easing: Easing.in(Easing.linear),\n      }).start();\n    }\n  };\n\n  private isIndicatorShown = false;\n\n  private opacity = new Animated.Value(this.props.width === 'auto' ? 0 : 1);\n\n  private getTranslateX = memoize(\n    (\n      position: Animated.Node<number>,\n      routes: Route[],\n      getTabWidth: GetTabWidth\n    ) => {\n      const inputRange = routes.map((_, i) => i);\n\n      // every index contains widths at all previous indices\n      const outputRange = routes.reduce<number[]>((acc, _, i) => {\n        if (i === 0) return [0];\n        return [...acc, acc[i - 1] + getTabWidth(i - 1)];\n      }, []);\n\n      const translateX = interpolate(position, {\n        inputRange,\n        outputRange,\n        extrapolate: Extrapolate.CLAMP,\n      });\n\n      return multiply(translateX, I18nManager.isRTL ? -1 : 1);\n    }\n  );\n\n  private getWidth = memoize(\n    (\n      position: Animated.Node<number>,\n      routes: Route[],\n      getTabWidth: GetTabWidth\n    ) => {\n      const inputRange = routes.map((_, i) => i);\n      const outputRange = inputRange.map(getTabWidth);\n\n      return interpolate(position, {\n        inputRange,\n        outputRange,\n        extrapolate: Extrapolate.CLAMP,\n      });\n    }\n  );\n\n  render() {\n    const {\n      position,\n      navigationState,\n      getTabWidth,\n      width,\n      style,\n      layout,\n      backgroundStyle,\n    } = this.props;\n    const { routes } = navigationState;\n    //a friendly reminder\n    const translateX =\n      routes.length > 1 ? this.getTranslateX(position, routes, getTabWidth) : 0;\n\n    const indicatorWidth =\n      width === 'auto'\n        ? routes.length > 1\n          ? this.getWidth(position, routes, getTabWidth)\n          : getTabWidth(0)\n        : width;\n\n    return (\n      <Animated.View style={[styles.indicatorBackground, backgroundStyle]}>\n        <Animated.View\n          style={[\n            styles.indicator,\n            // If layout is not available, use `left` property for positioning the indicator\n            // This avoids rendering delay until we are able to calculate translateX\n            { width: indicatorWidth },\n            layout.width\n              ? { transform: [{ translateX }] as any }\n              : { left: `${(100 / routes.length) * navigationState.index}%` },\n            width === 'auto' ? { opacity: this.opacity } : null,\n            style,\n          ]}\n        />\n      </Animated.View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  indicator: {\n    backgroundColor: '#ffeb3b',\n    position: 'absolute',\n    left: 0,\n    bottom: 0,\n    right: 0,\n    height: 2,\n  },\n  indicatorBackground: {\n    backgroundColor: 'red',\n    position: 'absolute',\n    left: 0,\n    bottom: 0,\n    right: 0,\n    height: 2,\n  },\n});\n"]}